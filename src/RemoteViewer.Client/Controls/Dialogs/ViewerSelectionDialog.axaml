<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mi="using:Material.Icons.Avalonia"
        xmlns:controls="using:RemoteViewer.Client.Controls"
        xmlns:dialogs="using:RemoteViewer.Client.Controls.Dialogs"
        xmlns:presenter="using:RemoteViewer.Client.Views.Presenter"
        xmlns:theme="using:RemoteViewer.Client.Themes"
        x:Class="RemoteViewer.Client.Controls.Dialogs.ViewerSelectionDialog"
        x:DataType="dialogs:ViewerSelectionDialogViewModel"
        Title="Send File"
        Icon="/Assets/avalonia-logo.ico"
        SizeToContent="WidthAndHeight"
        CanResize="False"
        ShowInTaskbar="False"
        WindowStartupLocation="CenterOwner">

    <Border Padding="{theme:Spacing XL}"
            MinWidth="320"
            MaxWidth="400">

        <StackPanel Spacing="{theme:Gap LG}">

            <!-- Header using DialogHeader control -->
            <controls:DialogHeader Icon="FileUpload"
                                   IconForeground="{DynamicResource ToastTransferAccentBrush}"
                                   IconBackground="{DynamicResource BadgeBackgroundBrush}"
                                   Title="Send File"
                                   Subtitle="Select recipients"/>

            <!-- File info card using Card component -->
            <controls:Card>
                <Grid ColumnDefinitions="Auto,*">
                    <mi:MaterialIcon Grid.Column="0"
                                     Kind="File"
                                     Classes="icon-sm"
                                     Margin="{theme:Spacing X=MD}"
                                     VerticalAlignment="Center"
                                     Foreground="{DynamicResource TextSecondaryBrush}"/>
                    <StackPanel Grid.Column="1" Spacing="{theme:Gap XXS}">
                        <TextBlock Text="{Binding FileName}"
                                   Classes="h3"
                                   TextTrimming="CharacterEllipsis"
                                   ToolTip.Tip="{Binding FileName}"/>
                        <TextBlock Text="{Binding FileSizeFormatted}"
                                   Classes="m1"/>
                    </StackPanel>
                </Grid>
            </controls:Card>

            <!-- Viewer selection list -->
            <StackPanel Spacing="{theme:Gap SM}">
                <TextBlock Text="Recipients"
                           Classes="m1"
                           Margin="{theme:Spacing Left=XXS}"
                           FontWeight="SemiBold"/>

                <ItemsControl ItemsSource="{Binding Viewers}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="presenter:PresenterViewerDisplay">
                            <controls:Card Size="ListItem" Margin="{theme:Spacing Bottom=SM}">
                                <CheckBox IsChecked="{Binding IsSelected}"
                                          Cursor="Hand">
                                    <StackPanel Orientation="Horizontal" Spacing="{theme:Gap SM}">
                                        <mi:MaterialIcon Kind="Account"
                                                         Classes="icon-xs"
                                                         VerticalAlignment="Center"
                                                         Foreground="{DynamicResource TextSecondaryBrush}"/>
                                        <TextBlock Text="{Binding DisplayName}"
                                                   VerticalAlignment="Center"/>
                                    </StackPanel>
                                </CheckBox>
                            </controls:Card>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>

            <!-- Action buttons -->
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="{theme:GridSpacing SM}"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Button Grid.Column="0"
                        Classes="action-secondary"
                        HorizontalAlignment="Stretch"
                        Click="OnCancelClicked">
                    <StackPanel Orientation="Horizontal" Spacing="{theme:Gap Icon}">
                        <mi:MaterialIcon Kind="Close" Classes="icon-xs"/>
                        <TextBlock Text="Cancel" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>

                <Button Grid.Column="2"
                        Classes="action-primary"
                        HorizontalAlignment="Stretch"
                        Click="OnSendClicked">
                    <StackPanel Orientation="Horizontal" Spacing="{theme:Gap Icon}">
                        <mi:MaterialIcon Kind="Send" Classes="icon-xs"/>
                        <TextBlock Text="Send" VerticalAlignment="Center"/>
                    </StackPanel>
                </Button>
            </Grid>

        </StackPanel>
    </Border>
</Window>
