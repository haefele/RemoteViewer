<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mi="using:Material.Icons.Avalonia"
        xmlns:controls="using:RemoteViewer.Client.Controls"
        xmlns:dialogs="using:RemoteViewer.Client.Controls.Dialogs"
        xmlns:presenter="using:RemoteViewer.Client.Views.Presenter"
        x:Class="RemoteViewer.Client.Controls.Dialogs.ViewerSelectionDialog"
        x:DataType="dialogs:ViewerSelectionDialogViewModel"
        Title="Send File"
        Icon="/Assets/avalonia-logo.ico"
        SizeToContent="WidthAndHeight"
        CanResize="False"
        ShowInTaskbar="False"
        WindowStartupLocation="CenterOwner">

    <Border Classes="p-xl"
            MinWidth="320"
            MaxWidth="400">

        <StackPanel Classes="gap-lg">

            <!-- Header using DialogHeader control -->
            <controls:DialogHeader Icon="FileUpload"
                                   IconForeground="{DynamicResource ToastTransferAccentBrush}"
                                   IconBackground="{DynamicResource BadgeBackgroundBrush}"
                                   Title="Send File"
                                   Subtitle="Select recipients"/>

            <!-- File info card using design system styles -->
            <Border Classes="card">
                <Grid ColumnDefinitions="Auto,*">
                    <mi:MaterialIcon Grid.Column="0"
                                     Kind="File"
                                     Width="{StaticResource IconSizeMD}"
                                     Height="{StaticResource IconSizeMD}"
                                     Classes="mx-md justify-center text-secondary"/>
                    <StackPanel Grid.Column="1" Classes="gap-xxs">
                        <TextBlock Text="{Binding FileName}"
                                   Classes="header-small truncate"
                                   ToolTip.Tip="{Binding FileName}"/>
                        <TextBlock Text="{Binding FileSizeFormatted}"
                                   Classes="small"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Viewer selection list -->
            <StackPanel Classes="gap-sm">
                <TextBlock Text="Recipients"
                           Classes="caption ml-xxs"
                           FontWeight="SemiBold"/>

                <ItemsControl ItemsSource="{Binding Viewers}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate x:DataType="presenter:PresenterViewerDisplay">
                            <Border Classes="list-item mb-sm">
                                <CheckBox IsChecked="{Binding IsSelected}"
                                          Classes="cursor-pointer">
                                    <StackPanel Classes="flex-row gap-sm">
                                        <mi:MaterialIcon Kind="Account"
                                                         Width="{StaticResource IconSizeSM}"
                                                         Height="{StaticResource IconSizeSM}"
                                                         Classes="justify-center text-secondary"/>
                                        <TextBlock Text="{Binding DisplayName}"
                                                   Classes="body-small justify-center"/>
                                    </StackPanel>
                                </CheckBox>
                            </Border>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </StackPanel>

            <!-- Action buttons -->
            <Grid ColumnDefinitions="*,10,*">
                <Button Grid.Column="0"
                        Classes="action-secondary w-full"
                        Click="OnCancelClicked">
                    <StackPanel Classes="flex-row gap-icon">
                        <mi:MaterialIcon Kind="Close" Width="{StaticResource IconSizeSM}" Height="{StaticResource IconSizeSM}"/>
                        <TextBlock Text="Cancel" Classes="justify-center"/>
                    </StackPanel>
                </Button>

                <Button Grid.Column="2"
                        Classes="action-primary w-full"
                        Click="OnSendClicked">
                    <StackPanel Classes="flex-row gap-icon">
                        <mi:MaterialIcon Kind="Send" Width="{StaticResource IconSizeSM}" Height="{StaticResource IconSizeSM}"/>
                        <TextBlock Text="Send" Classes="justify-center"/>
                    </StackPanel>
                </Button>
            </Grid>

        </StackPanel>
    </Border>
</Window>
