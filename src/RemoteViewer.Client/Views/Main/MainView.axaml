<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:RemoteViewer.Client.Views.Main"
        xmlns:conv="using:RemoteViewer.Client.Converters"
        xmlns:toastControls="using:RemoteViewer.Client.Controls.Toasts"

        x:Class="RemoteViewer.Client.Views.Main.MainView"
        x:DataType="vm:MainViewModel"

        Icon="/Assets/avalonia-logo.ico"
        Title="Remote Viewer"
        CanResize="False"

        Width="500"
        Height="300"

        DataContextChanged="Window_DataContextChanged">
    <Panel>
        <!-- Main Content -->
        <DockPanel>
            <!-- Status Bar at Bottom -->
            <Border DockPanel.Dock="Bottom"
                    Background="{DynamicResource SystemControlBackgroundChromeMediumBrush}"
                    Padding="10,6">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <Ellipse Width="12" Height="12">
                        <Ellipse.Fill>
                            <SolidColorBrush Color="{Binding IsConnected, Converter={x:Static conv:BoolToColorConverter.Instance}}"/>
                        </Ellipse.Fill>
                    </Ellipse>
                    <TextBlock Text="{Binding StatusText}"
                               VerticalAlignment="Center"
                               FontSize="12"/>
                </StackPanel>
            </Border>

            <!-- Main Content -->
            <Grid ColumnDefinitions="*,*" Margin="16">
                <!-- Left Panel - Your Credentials -->
                <Border Grid.Column="0"
                        Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                        CornerRadius="8"
                        Padding="16"
                        Margin="0,0,8,0">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Your Credentials"
                                   FontWeight="SemiBold"
                                   FontSize="16"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="ID"
                                       FontSize="12"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                            <SelectableTextBlock Text="{Binding YourUsername}"
                                                 Margin="0, 8, 0, 2"
                                                 FontFamily="Consolas, Courier New, monospace"
                                                 FontSize="18"
                                                 FontWeight="Bold"/>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Password"
                                       FontSize="12"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                            <SelectableTextBlock Text="{Binding YourPassword}"
                                                 Margin="0, 8, 0, 2"
                                                 FontFamily="Consolas, Courier New, monospace"
                                                 FontSize="18"
                                                 FontWeight="Bold"/>
                        </StackPanel>

                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <Button Content="Copy"
                                    Command="{Binding CopyCredentialsCommand}"
                                    Padding="12,6"/>
                            <Button Content="New Password"
                                    Command="{Binding GenerateNewPasswordCommand}"
                                    Padding="12,6"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- Right Panel - Connect to Device -->
                <Border Grid.Column="1"
                        Background="{DynamicResource SystemControlBackgroundBaseLowBrush}"
                        CornerRadius="8"
                        Padding="16"
                        Margin="8,0,0,0">
                    <StackPanel Spacing="12">
                        <TextBlock Text="Connect to Device"
                                   FontWeight="SemiBold"
                                   FontSize="16"/>

                        <StackPanel Spacing="4">
                            <TextBlock Text="ID"
                                       FontSize="12"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                            <TextBox x:Name="TargetUsernameBox"
                                     Text="{Binding TargetUsername}"
                                     Watermark="Enter ID"
                                     IsEnabled="{Binding !ConnectToDeviceCommand.IsRunning}"
                                     PastingFromClipboard="TargetUsernameBox_Pasting"/>
                        </StackPanel>

                        <StackPanel Spacing="4">
                            <TextBlock Text="Password"
                                       FontSize="12"
                                       Foreground="{DynamicResource SystemControlForegroundBaseMediumBrush}"/>
                            <TextBox x:Name="TargetPasswordBox"
                                     Text="{Binding TargetPassword}"
                                     Watermark="Enter password"
                                     PasswordChar="*"
                                     IsEnabled="{Binding !ConnectToDeviceCommand.IsRunning}"
                                     KeyDown="TargetPasswordBox_KeyDown"/>
                        </StackPanel>

                        <Button Content="{Binding ConnectToDeviceCommand.IsRunning, Converter={x:Static conv:BoolToConnectTextConverter.Instance}}"
                                Command="{Binding ConnectToDeviceCommand}"
                                HorizontalAlignment="Stretch"
                                HorizontalContentAlignment="Center"
                                Classes="accent"
                                IsEnabled="{Binding !ConnectToDeviceCommand.IsRunning}"
                                Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>
            </Grid>
        </DockPanel>

        <toastControls:ToastsView DataContext="{Binding Toasts}"
                                  VerticalAlignment="Bottom"
                                  HorizontalAlignment="Right"
                                  Margin="0,0,8,8"/>
    </Panel>
</Window>
